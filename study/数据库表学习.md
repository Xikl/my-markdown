# 数据库表的学习
#### 1. 表名称的学习
- QY 企业 JY 经营 YW 业务
- SYBZ 试用标志 ZHXGSJ 最后修改时间
- DLBZ 代理标志 TCQDMX 套餐清单明细
- KM 科目 CJR 创建人
- KHGL_GRDLXX 客户管理_会计信息表 个人代理信息表
- KHGL_DLSJBXX 客户管理_中介机构信息表

#### 2.主要表格的学习
```
    KHGL_DWKH_COREINFO 客户核心信息表 与YYFX.DIM_DWKH基本一样;
    KHGL_DWKHJBXX 客户基本信息;

    KHGL_DLSJBXX 中介机构表来自于CC_CUSTOMER_PROFILE_INFO;
    KHGL_GRDLXX 个人代理表来自于CC_CUSTOMER_PROFILE_INFO;
    KHGL_KHYWDLXX 客户所属网点客户经理表;

    GIC_COMPANY_MAIN --来源阿里云 主要惠税使用
    GIC_GROUP  ---来源阿里云 主要是小企业使用
    UIC_ACCOUNT  --账户信息

    SWGL_DDJBXX 订单基本信息;
    SWGL_DDCPBXX 订单产品包信息;
    SWGL_DDHJXX 订单环节信息;

    CPGL_CPBJBXX 产品包基本信息
    CPGL_CPBBBJBXX 产品包版本基本信息
    CPGL_RJJBXX 软件基本信息

```
#### 3.查数学习
```
    原始需求：统计下亿企惠税微门户升级到V1.2.007的用户明细数据
业务目的：XXX
时间口径：升级日期
数据范围：2017年12月1日-2018年1月30日
导出信息：纳税识别号、单位名称、亿企惠税微门户版本号、升级时间
执行SQL：SELECT t.qysh as 企业税号,a.khmc as 客户名称,max(t.sjqbbh),min(t.sjrq)
FROM sqkz_cpsjlog 纳税人版本设计表 t
JOIN dim_dwkh_dmdzb kh
    ON t.qysh = kh.khdm
join dim_kh_all a 
    on a.kh_id = kh.dwkh_id 客户 id 和 单位客户id
//升级日期 > ''
WHERE t.sjrq > '2017-11-30'
        AND t.jccp_dm = '07620100010000'
        and t.sjqbbh >= 'V01.2.007' 升级前版本号
        AND kh.fzgs_dm = '001093' 分子公司代码
        group by t.qysh,a.khmc    企业税号， 客户名称
```
- 企业税号 = 客户代码
SELECT t.qysh,a.khmc,max(t.sjqbbh),min(t.sjrq)
FROM sqkz_cpsjlog t
JOIN dim_dwkh_dmdzb kh
    ON t.qysh = kh.khdm
join dim_kh_all a
    on a.kh_id = kh.dwkh_id
WHERE t.sjrq > '2017-11-30'
        AND t.jccp_dm = '07620100010000'
        and t.sjqbbh >= 'V01.2.007'
        AND kh.fzgs_dm = '001093'
        group by t.qysh,a.khmc                                                 
- ECYWLX 二次业务类型？？？？？？ 到期 2，3 为退货
- thbz 退货标志 
- 

#### 4. 查 数 工 具平台 
- select * from yyfx.Csgd_Detail 

#### 5. HIVE的用法总结
- 1.lateral view 个人理解就是把Hive中一个字段拆分如下所示，拆分为1，2
```
Array<int> col1, [1, 2]
完整代码：
SELECT myCol1, col2 FROM baseTable
    LATERAL VIEW explode(col1) myTable1 AS myCol1;
```
具体参见：http://blog.csdn.net/clerk0324/article/details/58600284
